"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[647],{647:(fe,S,o)=>{o.r(S),o.d(S,{SpreadsheetsModule:()=>me});var d=o(8583),e=o(7716),x=o(7170),U=o(5108),m=o(9529),u=o(805),C=o(1740),Z=o(7489),h=o(5593),f=o(1795),v=o(1436),c=o(3423);function D(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"span",10),e._UZ(2,"i",11),e.TgZ(3,"input",12),e.NdJ("input",function(i){return e.CHM(t),e.oxw(),e.MAs(8).filterGlobal(i.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}function _(a,s){if(1&a&&(e.TgZ(0,"th",14),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&a){const t=s.$implicit;e.Q6J("id",t),e.xp6(1),e.Oqu(e.lcZ(2,2,t))}}function b(a,s){if(1&a&&(e.TgZ(0,"tr"),e.YNc(1,_,3,4,"th",13),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.headersTable)}}function y(a,s){1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-skeleton"),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"p-skeleton"),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-skeleton"),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"p-skeleton"),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"p-skeleton"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"p-skeleton"),e.qZA(),e.qZA())}const E=function(a){return["review",a]};function R(a,s){if(1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"button",16),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.Planilla.IDE.numero),e.xp6(2),e.Oqu(t.Planilla.IDE.fecha),e.xp6(2),e.Oqu(t.Planilla.IDE.Placa),e.xp6(2),e.Oqu(t.Planilla.IDE.chofer),e.xp6(2),e.Oqu(t.Planilla.GUIAS.length),e.xp6(2),e.Q6J("routerLink",e.VKq(6,E,t.id))}}function w(a,s){if(1&a&&(e.YNc(0,y,13,0,"tr",15),e.YNc(1,R,13,8,"tr",15)),2&a){const t=e.oxw();e.Q6J("ngIf",null===t.spreadSheets),e.xp6(1),e.Q6J("ngIf",t.spreadSheets)}}const F=function(){return["Planilla.IDE.placa","Planilla.IDE.numero"]},J=function(){return[10,20,40]};let N=(()=>{class a{constructor(t){this.spreadsheetsService=t,this.headersTable=["Planilla","Fecha","Placa","Chofer","#Guias","Acciones"],this.spreadSheets=null}ngOnInit(){let t=[];this.spreadsheetsService.getSpreadSheets().subscribe(n=>{this.spreadsheetsService.getSpreadSheetBdd().subscribe(i=>{i.worksheets.length>0?n.respon.forEach(l=>{i.worksheets.forEach(p=>{l.id!==p.id&&t.push(l)})}):t=n.respon,this.spreadSheets=t})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.$))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-spreadsheets"]],decls:12,vars:9,consts:[[1,"p-5","w-screen"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],[1,"w-full","pt-3"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","100%",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-eye","matTooltip","Ver detalles",1,"p-button-rounded","p-button-outlined","mr-2",3,"routerLink"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"div",1),e.TgZ(3,"h1",2),e._uU(4,"Revisi\xf3n planillas"),e.qZA(),e.qZA(),e._UZ(5,"p-divider"),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"p-table",4,5),e.YNc(9,D,4,0,"ng-template",6),e.YNc(10,b,2,1,"ng-template",7),e.YNc(11,w,2,2,"ng-template",8),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("scrollable",null!==n.spreadSheets)("value",null===n.spreadSheets?n.headersTable.concat(n.headersTable):n.spreadSheets)("paginator",!0)("globalFilterFields",e.DdM(7,F))("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(8,J)))},directives:[U.i,m.iA,u.jx,C.o,d.sg,d.O5,Z.O,h.Hq,f.H,v.gM,c.rH],pipes:[d.rS],styles:[""]}),a})();var P=o(2453),M=o(1512),I=o(3679),O=o(7913),Y=o(3520),T=o(1095),q=o(4885),G=o(6627),L=o(8295),Q=o(9983),j=o(7648),H=o(3631),g=o(6457),z=o(7441),$=o(2613),B=o(3220),V=o(2458),W=o(5396),k=o(2210),X=o(5722),K=o(3738),ee=o(1554),A=o(2238);let te=(()=>{class a{constructor(t,n,i){this._mapsAPILoader=t,this.data=n,this.dialogRef=i}ngOnInit(){this._mapsAPILoader.load().then(()=>{this.setCurrentLocation()})}setCurrentLocation(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude},t=>{console.log(t),this.lat=-12.040607,this.lng=-77.040365})}handleDrag(t,n){this.data={lat:t.coords.lat,lng:t.coords.lng,index:n}}aceptar(){this.dialogRef.close(this.data)}cerrar(){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(g.W7),e.Y36(A.WI),e.Y36(A.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dialog-map"]],decls:11,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"w-full","h-100",3,"latitude","longitude","zoom","fullscreenControl"],[1,"w-5","h-5",3,"latitude","longitude","markerDraggable","dragEnd"],["mat-dialog-actions",""],["mat-button","","color","blue",3,"click"],["mat-button","",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Editar Coordenadas"),e.qZA(),e._UZ(2,"hr"),e.TgZ(3,"div",1),e.TgZ(4,"agm-map",2),e.TgZ(5,"agm-marker",3),e.NdJ("dragEnd",function(l){return n.handleDrag(l,n.data.index)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",4),e.TgZ(7,"button",5),e.NdJ("click",function(){return n.aceptar()}),e._uU(8," Aceptar "),e.qZA(),e.TgZ(9,"button",6),e.NdJ("click",function(){return n.cerrar()}),e._uU(10,"Cancelar"),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("latitude",n.data.lat)("longitude",n.data.lng)("zoom",14)("fullscreenControl",!0),e.xp6(1),e.Q6J("latitude",n.data.lat)("longitude",n.data.lng)("markerDraggable",!0))},directives:[g.SA,g.pt,T.lW],styles:[""]}),a})();var ae=o(2927),ne=o(1769);function oe(a,s){1&a&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e._UZ(2,"mat-spinner",5),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.Q6J("diameter",50)("mode","indeterminate"))}function ie(a,s){if(1&a&&(e.TgZ(0,"th",20),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&a){const t=s.$implicit;e.Q6J("id",t),e.xp6(1),e.hij(" ",e.lcZ(2,2,t)," ")}}function le(a,s){if(1&a&&(e.TgZ(0,"tr"),e.YNc(1,ie,3,4,"th",19),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.headersTable)}}function se(a,s){1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-skeleton"),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"p-skeleton"),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-skeleton"),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"p-skeleton"),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"p-skeleton"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"p-skeleton"),e.qZA(),e.qZA())}function re(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e._UZ(9,"br"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),l=i.$implicit,p=i.rowIndex;return e.oxw(2).openDialog(l.latitud,l.longitud,p)}),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.cliente),e.xp6(2),e.Oqu(t.Direccion),e.xp6(2),e.Oqu(t.nroguia),e.xp6(2),e.hij(" ",t.latitud,","),e.xp6(2),e.hij("",t.longitud," ")}}function de(a,s){if(1&a&&(e.YNc(0,se,13,0,"tr",2),e.YNc(1,re,13,5,"tr",2)),2&a){const t=e.oxw(2);e.Q6J("ngIf",null===t.spreadSheet.Planilla.GUIAS),e.xp6(1),e.Q6J("ngIf",t.spreadSheet.Planilla.GUIAS)}}const pe=function(){return["/spreadsheets"]},ce=function(){return["Planilla.IDE.placa","Planilla.IDE.numero"]},ge=function(){return[10,20,40]};function ue(a,s){if(1&a){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",6),e.TgZ(2,"h1",7),e._uU(3,"Editar planilla"),e.qZA(),e._UZ(4,"p-button",8),e.qZA(),e._UZ(5,"mat-divider"),e.TgZ(6,"div",9),e.TgZ(7,"div",10),e.TgZ(8,"h3",11),e._uU(9,"Planilla:"),e.qZA(),e.TgZ(10,"h3",12),e._uU(11),e.qZA(),e.qZA(),e.TgZ(12,"div",10),e.TgZ(13,"h3",11),e._uU(14,"Placa:"),e.qZA(),e.TgZ(15,"h3",12),e._uU(16),e.qZA(),e.qZA(),e.TgZ(17,"div",10),e.TgZ(18,"h3",11),e._uU(19,"Fecha:"),e.qZA(),e.TgZ(20,"h3",12),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"div",10),e.TgZ(23,"h3",11),e._uU(24,"Chofer:"),e.qZA(),e.TgZ(25,"h3",12),e._uU(26),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"div",13),e.TgZ(28,"p-table",14,15),e.YNc(30,le,2,1,"ng-template",16),e.YNc(31,de,2,2,"ng-template",17),e.qZA(),e.qZA(),e.TgZ(32,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().addSpreadSheet()}),e._uU(33," Guardar"),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(4),e.Q6J("routerLink",e.DdM(13,pe)),e.xp6(7),e.hij(" ",t.spreadSheet.Planilla.IDE.numero," "),e.xp6(5),e.hij(" ",t.spreadSheet.Planilla.IDE.Placa," "),e.xp6(5),e.hij(" ",t.spreadSheet.Planilla.IDE.fecha," "),e.xp6(5),e.hij(" ",t.spreadSheet.Planilla.IDE.chofer," "),e.xp6(2),e.Q6J("scrollable",null!==t.spreadSheet.Planilla.GUIAS)("value",null===t.spreadSheet.Planilla.GUIAS?t.headersTable.concat(t.headersTable):t.spreadSheet.Planilla.GUIAS)("paginator",!1)("globalFilterFields",e.DdM(14,ce))("rows",10)("showCurrentPageReport",!1)("rowsPerPageOptions",e.DdM(15,ge)),e.xp6(4),e.Q6J("color","primary")}}const he=[{path:"",component:N},{path:"review/:id",component:(()=>{class a{constructor(t,n,i,l,p,r,Ze){this.spreadsheetsService=t,this.activatedRoute=n,this._mapsAPILoader=i,this._requestService=l,this.messageService=p,this.router=r,this._matDialog=Ze,this.loading=!0,this.lat=-12.0442184,this.lng=-77.0455705,this.headersTable=["Cliente","Direcci\xf3n","Guia","Ubicaci\xf3n","Revisar"]}ngOnInit(){const t=this.activatedRoute.snapshot.paramMap.get("id");this.spreadsheetsService.getSpreadSheets().subscribe(n=>{const i=n.respon.filter(l=>l.id===t);this.spreadSheet=i[0],this.loading=!1}),this._requestService.getCatalogo("STATESPREAD").subscribe(n=>{this.estadoPlanilla=n.catalog.detailCatalog.filter(i=>"REVISADA"===i.name)}),this._requestService.getCatalogo("STATEGUIDES").subscribe(n=>{this.estadoGuia=n.catalog.detailCatalog.filter(i=>"PENDIENTE"===i.name)}),this._mapsAPILoader.load().then(()=>{this.setCurrentLocation(),this.geocoder=new google.maps.Geocoder})}setCurrentLocation(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude},t=>{console.log(t),this.lat=-12.040607,this.lng=-77.040365})}handleDrag(t,n,i){this.spreadSheet.Planilla.GUIAS[i].latitud=t.coords.lat,this.spreadSheet.Planilla.GUIAS[i].longitud=t.coords.lng}addSpreadSheet(){const t={id:this.spreadSheet.id,worksheetStatus:this.estadoPlanilla[0].id,fecha:this.spreadSheet.Planilla.IDE.fecha,placa:this.spreadSheet.Planilla.IDE.Placa,numero:this.spreadSheet.Planilla.IDE.numero,chofer:this.spreadSheet.Planilla.IDE.chofer,guide:null};if(this.spreadSheet.Planilla.GUIAS.some(l=>""===l.latitud||""===l.longitu1d))return void this.messageService.add({severity:"error",detail:"Hay ubicaciones faltantes de corregir",summary:"Ubicaci\xf3n Erronea"});const i=this.spreadSheet.Planilla.GUIAS.map(l=>({clientName:l.cliente,guideAddress:l.Direccion,lat:l.latitud,lng:l.longitud,guideNumber:l.nroguia,deliveryStatus:this.estadoGuia[0].id,detail:JSON.stringify(l.DETALLE),image:""}));t.guide=i,this.spreadsheetsService.saveSpreadSheets(t).subscribe(l=>{this.messageService.add({severity:"success",detail:"Se registro correctamente.",summary:"Transaccion correcta"}),setTimeout(()=>{this.router.navigate(["/spreadsheets"])},2e3)},l=>{this.messageService.add({severity:"error",detail:"Error al guardar, pongase en contacto con el administrador",summary:"Transaccion erronea"})})}openDialog(t,n,i){const l={lat:""!==t?parseFloat(t):"",lng:""!==n?parseFloat(n):"",index:i};this._matDialog.open(te,{width:"800px",data:l}).afterClosed().subscribe(r=>{r&&(this.spreadSheet.Planilla.GUIAS[r.index].latitud=r.lat,this.spreadSheet.Planilla.GUIAS[r.index].longitud=r.lng,this.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se cambio la direcci\xf3n"}))})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(x.$),e.Y36(c.gz),e.Y36(g.W7),e.Y36(ae.s),e.Y36(u.ez),e.Y36(c.F0),e.Y36(A.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-review"]],features:[e._Bn([u.ez])],decls:4,vars:2,consts:[[1,"p-5","w-screen"],["class","grid justify-items-stretch",4,"ngIf"],[4,"ngIf"],[1,"grid","justify-items-stretch"],[1,"justify-self-center","pt-50"],[3,"diameter","mode"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Regresar","icon","pi pi-angle-left","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],[1,"grid","gap-4","md:grid-cols-2","sm:grid-cols-2","mt-2","bg-white","p-3","rounded-md"],[1,"flex","flex-row"],[1,"text-2xl","font-bold","mr-4"],[1,"text-2xl","font-light"],[1,"w-full","pt-3"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","100%",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["mat-flat-button","",1,"fuse-mat-button-medium","mt-1","mb-1","w-2/12",3,"color","click"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],["pButton","","pRipple","","type","button","icon","pi pi-eye","matTooltip","Ver Direcci\xf3n",1,"p-button-rounded","p-button-outlined","mr-2",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,oe,3,2,"div",1),e.YNc(2,ue,34,16,"div",2),e.qZA(),e._UZ(3,"p-toast")),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading))},directives:[d.O5,P.FN,q.$g,h.zx,c.rH,ne.d,m.iA,u.jx,T.lW,d.sg,Z.O,h.Hq,f.H,v.gM],pipes:[d.rS],styles:[""]}),a})()}];let me=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[d.ez,c.Bz.forChild(he),U.x,m.U$,Z.m,P.EV,C.j,h.hJ,f.T,M.S,I.UX,O.Iu,Y.zz,T.ot,q.Cq,G.Ps,v.AV,L.lN,Q.c,j.ie,H.WN,I.u5,g.su,z.LD,$.Fk,B.FA,V.XK,W.rP,k.kW,X.q4,K.QW,ee.Bb]]}),a})()}}]);