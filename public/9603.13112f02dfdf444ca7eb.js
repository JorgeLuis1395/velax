"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[9603],{9603:(de,m,n)=>{n.r(m),n.d(m,{SpreadsheetsModule:()=>le});var l=n(8583),e=n(7716),Z=n(7170),f=n(5108),v=n(9529),c=n(805),T=n(1740),S=n(7489),u=n(5593),A=n(1795),x=n(1436),d=n(3423);function E(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",9),e.TgZ(1,"span",10),e._UZ(2,"i",11),e.TgZ(3,"input",12),e.NdJ("input",function(s){return e.CHM(t),e.oxw(),e.MAs(8).filterGlobal(s.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}function q(a,r){if(1&a&&(e.TgZ(0,"th",14),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&a){const t=r.$implicit;e.Q6J("id",t),e.xp6(1),e.Oqu(e.lcZ(2,2,t))}}function D(a,r){if(1&a&&(e.TgZ(0,"tr"),e.YNc(1,q,3,4,"th",13),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.headersTable)}}function y(a,r){1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-skeleton"),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"p-skeleton"),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-skeleton"),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"p-skeleton"),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"p-skeleton"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"p-skeleton"),e.qZA(),e.qZA())}const b=function(a){return["review",a]};function F(a,r){if(1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"button",16),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.Planilla.IDE.numero),e.xp6(2),e.Oqu(t.Planilla.IDE.fecha),e.xp6(2),e.Oqu(t.Planilla.IDE.Placa),e.xp6(2),e.Oqu(t.Planilla.IDE.chofer),e.xp6(2),e.Oqu(t.Planilla.GUIAS.length),e.xp6(2),e.Q6J("routerLink",e.VKq(6,b,t.id))}}function R(a,r){if(1&a&&(e.YNc(0,y,13,0,"tr",15),e.YNc(1,F,13,8,"tr",15)),2&a){const t=e.oxw();e.Q6J("ngIf",null===t.spreadSheets),e.xp6(1),e.Q6J("ngIf",t.spreadSheets)}}const J=function(){return["Planilla.IDE.placa","Planilla.IDE.numero"]},N=function(){return[10,20,40]};let O=(()=>{class a{constructor(t){this.spreadsheetsService=t,this.headersTable=["Planilla","Fecha","Placa","Chofer","#Guias","Acciones"],this.spreadSheets=null}ngOnInit(){let t=[];this.spreadsheetsService.getSpreadSheets().subscribe(i=>{this.spreadsheetsService.getSpreadSheetBdd().subscribe(s=>{s.worksheets.length>0?i.respon.forEach(o=>{s.worksheets.forEach(g=>{o.id!==g.id&&t.push(o)})}):t=i.respon,this.spreadSheets=t})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Z.$))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-spreadsheets"]],decls:12,vars:9,consts:[[1,"p-5","w-screen"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],[1,"w-full","pt-3"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","100%",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-eye","matTooltip","Ver detalles",1,"p-button-rounded","p-button-outlined","mr-2",3,"routerLink"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"div",1),e.TgZ(3,"h1",2),e._uU(4,"Revisi\xf3n planillas"),e.qZA(),e.qZA(),e._UZ(5,"p-divider"),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"p-table",4,5),e.YNc(9,E,4,0,"ng-template",6),e.YNc(10,D,2,1,"ng-template",7),e.YNc(11,R,2,2,"ng-template",8),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.Q6J("scrollable",null!==i.spreadSheets)("value",null===i.spreadSheets?i.headersTable.concat(i.headersTable):i.spreadSheets)("paginator",!0)("globalFilterFields",e.DdM(7,J))("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(8,N)))},directives:[f.i,v.iA,c.jx,T.o,l.sg,l.O5,S.O,u.Hq,A.H,x.gM,d.rH],pipes:[l.rS],styles:[""]}),a})();var U=n(2453),w=n(1512),C=n(3679),Y=n(7913),Q=n(3520),P=n(1095),I=n(4885),G=n(6627),M=n(8295),j=n(9983),L=n(7648),z=n(3631),p=n(6457),H=n(7441),$=n(2613),B=n(3220),V=n(2458),W=n(5396),X=n(2210),K=n(5722),k=n(3738),_=n(1554),ee=n(2927),te=n(1769);function ae(a,r){1&a&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"mat-spinner",6),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.Q6J("diameter",50)("mode","indeterminate"))}const ne=function(){return["/spreadsheets"]};function ie(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",7),e.TgZ(2,"h1",8),e._uU(3,"Editar planilla"),e.qZA(),e._UZ(4,"p-button",9),e.qZA(),e._UZ(5,"mat-divider"),e.TgZ(6,"div",10),e.TgZ(7,"div",11),e.TgZ(8,"h3",12),e._uU(9,"Planilla:"),e.qZA(),e.TgZ(10,"h3",13),e._uU(11),e.qZA(),e.qZA(),e.TgZ(12,"div",11),e.TgZ(13,"h3",12),e._uU(14,"Placa:"),e.qZA(),e.TgZ(15,"h3",13),e._uU(16),e.qZA(),e.qZA(),e.TgZ(17,"div",11),e.TgZ(18,"h3",12),e._uU(19,"Fecha:"),e.qZA(),e.TgZ(20,"h3",13),e._uU(21),e.qZA(),e.qZA(),e.TgZ(22,"div",11),e.TgZ(23,"h3",12),e._uU(24,"Chofer:"),e.qZA(),e.TgZ(25,"h3",13),e._uU(26),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().addSpreadSheet()}),e._uU(28," Guardar"),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(4),e.Q6J("routerLink",e.DdM(6,ne)),e.xp6(7),e.hij(" ",t.spreadSheet.Planilla.IDE.numero," "),e.xp6(5),e.hij(" ",t.spreadSheet.Planilla.IDE.Placa," "),e.xp6(5),e.hij(" ",t.spreadSheet.Planilla.IDE.fecha," "),e.xp6(5),e.hij(" ",t.spreadSheet.Planilla.IDE.chofer," "),e.xp6(1),e.Q6J("color","primary")}}function se(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"agm-marker",18),e.NdJ("dragEnd",function(s){const o=e.CHM(t),g=o.$implicit,h=o.index;return e.oxw(2).handleDrag(s,g,h)}),e._uU(1),e.TgZ(2,"agm-info-window"),e.TgZ(3,"div",19),e.TgZ(4,"h3",20),e._uU(5,"Direcci\xf3n"),e.qZA(),e.TgZ(6,"h3",21),e._uU(7),e.qZA(),e.TgZ(8,"h3",20),e._uU(9,"Cliente"),e.qZA(),e.TgZ(10,"h3",21),e._uU(11),e.qZA(),e.TgZ(12,"h3",20),e._uU(13,"Guia"),e.qZA(),e.TgZ(14,"h3",21),e._uU(15),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=r.$implicit,i=r.index;e.Q6J("latitude",t.latitud)("longitude",t.longitud)("markerDraggable",!0),e.xp6(1),e.hij(" ",i+1," "),e.xp6(6),e.Oqu(t.Direccion),e.xp6(4),e.Oqu(t.cliente),e.xp6(4),e.Oqu(t.nroguia)}}function oe(a,r){if(1&a&&(e.TgZ(0,"div",15),e.TgZ(1,"agm-map",16),e.YNc(2,se,16,7,"agm-marker",17),e.qZA(),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("latitude",t.lat)("longitude",t.lng)("zoom",14)("disableDoubleClickZoom",!0)("fullscreenControl",!0),e.xp6(1),e.Q6J("ngForOf",t.spreadSheet.Planilla.GUIAS)}}const re=[{path:"",component:O},{path:"review/:id",component:(()=>{class a{constructor(t,i,s,o,g,h){this.spreadsheetsService=t,this.activatedRoute=i,this._mapsAPILoader=s,this._requestService=o,this.messageService=g,this.router=h,this.loading=!0,this.lat=-12.0442184,this.lng=-77.0455705}ngOnInit(){const t=this.activatedRoute.snapshot.paramMap.get("id");this.spreadsheetsService.getSpreadSheets().subscribe(i=>{const s=i.respon.filter(o=>o.id===t);console.log(s),this.spreadSheet=s[0],this.loading=!1}),this._requestService.getCatalogo("STATESPREAD").subscribe(i=>{this.estadoPlanilla=i.catalog.detailCatalog.filter(s=>"REVISADA"===s.name)}),this._requestService.getCatalogo("STATEGUIDES").subscribe(i=>{this.estadoGuia=i.catalog.detailCatalog.filter(s=>"PENDIENTE"===s.name)}),this._mapsAPILoader.load().then(()=>{this.setCurrentLocation(),this.geocoder=new google.maps.Geocoder})}setCurrentLocation(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude},t=>{console.log(t),this.lat=-12.040607,this.lng=-77.040365})}handleDrag(t,i,s){console.log(t,i,s),console.log(this.spreadSheet.Planilla.GUIAS[s]),this.spreadSheet.Planilla.GUIAS[s].latitud=t.coords.lat,this.spreadSheet.Planilla.GUIAS[s].longitud=t.coords.lng}addSpreadSheet(){console.log(this.spreadSheet);const t={id:this.spreadSheet.id,worksheetStatus:this.estadoPlanilla[0].id,fecha:this.spreadSheet.Planilla.IDE.fecha,placa:this.spreadSheet.Planilla.IDE.Placa,numero:this.spreadSheet.Planilla.IDE.numero,chofer:this.spreadSheet.Planilla.IDE.chofer,guide:null},i=this.spreadSheet.Planilla.GUIAS.some(o=>""===o.latitud||""===o.longitu1d);if(console.log(i),i)return void this.messageService.add({severity:"error",detail:"Hay ubicaciones faltantes de corregir",summary:"Ubicaci\xf3n Erronea"});const s=this.spreadSheet.Planilla.GUIAS.map(o=>({clientName:o.cliente,guideAddress:o.Direccion,lat:o.latitud,lng:o.longitud,guideNumber:o.nroguia,deliveryStatus:this.estadoGuia[0].id,detail:JSON.stringify(o.DETALLE),image:""}));t.guide=s,this.spreadsheetsService.saveSpreadSheets(t).subscribe(o=>{this.messageService.add({severity:"success",detail:"Se registro correctamente.",summary:"Transaccion correcta"}),setTimeout(()=>{this.router.navigate(["/spreadsheets"])},2e3)},o=>{this.messageService.add({severity:"error",detail:"Error al guardar, pongase en contacto con el administrador",summary:"Transaccion erronea"})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Z.$),e.Y36(d.gz),e.Y36(p.W7),e.Y36(ee.s),e.Y36(c.ez),e.Y36(d.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-review"]],features:[e._Bn([c.ez])],decls:5,vars:3,consts:[[1,"p-5","w-screen"],["class","grid justify-items-stretch",4,"ngIf"],[4,"ngIf"],["class"," w-full h-3/4",4,"ngIf"],[1,"grid","justify-items-stretch"],[1,"justify-self-center","pt-50"],[3,"diameter","mode"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Regresar","icon","pi pi-angle-left","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],[1,"grid","gap-4","md:grid-cols-2","sm:grid-cols-2","mt-2","bg-white","p-3","rounded-md"],[1,"flex","flex-row"],[1,"text-2xl","font-bold","mr-4"],[1,"text-2xl","font-light"],["mat-flat-button","",1,"fuse-mat-button-medium","mt-1","mb-1","w-2/12",3,"color","click"],[1,"w-full","h-3/4"],[1,"w-full","h-full",3,"latitude","longitude","zoom","disableDoubleClickZoom","fullscreenControl"],["class","w-5 h-5",3,"latitude","longitude","markerDraggable","dragEnd",4,"ngFor","ngForOf"],[1,"w-5","h-5",3,"latitude","longitude","markerDraggable","dragEnd"],[1,"grid","grid-cols-2","gap-2","h-auto"],[1,"font-bold","text-lg"],[1,"text-lg"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ae,3,2,"div",1),e.YNc(2,ie,29,7,"div",2),e.YNc(3,oe,3,6,"div",3),e.qZA(),e._UZ(4,"p-toast")),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},directives:[l.O5,U.FN,I.$g,u.zx,d.rH,te.d,P.lW,p.SA,l.sg,p.pt,p.d],styles:[""]}),a})()}];let le=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[l.ez,d.Bz.forChild(re),f.x,v.U$,S.m,U.EV,T.j,u.hJ,A.T,w.S,C.UX,Y.Iu,Q.zz,P.ot,I.Cq,G.Ps,x.AV,M.lN,j.c,L.ie,z.WN,C.u5,p.su,H.LD,$.Fk,B.FA,V.XK,W.rP,X.kW,K.q4,k.QW,_.Bb]]}),a})()}}]);